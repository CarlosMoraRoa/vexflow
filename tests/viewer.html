<html>
  <head>
    <title>VexFlow MusicXML Demo</title>
    <meta name="viewport" content="initial-scale = 1.0, minimum-scale = 1.0, maximum-scale = 1.0, user-scalable = no">

    <script src="resources/jquery.js"></script>

    <!-- VexFlow Sources -->
    <script src="../src/header.js"></script>
    <script src="../src/vex.js"></script>
    <script src="../src/flow.js"></script>
    <script src="../src/fraction.js"></script>
    <script src="../src/fonts/vexflow_font.js"></script>
    <script src="../src/glyph.js"></script>
    <script src="../src/tables.js"></script>
    <script src="../src/stave.js"></script>
    <script src="../src/staveconnector.js"></script>
    <script src="../src/tabstave.js"></script>
    <script src="../src/voice.js"></script>
    <script src="../src/voicegroup.js"></script>
    <script src="../src/modifier.js"></script>
    <script src="../src/modifiercontext.js"></script>
    <script src="../src/accidental.js"></script>
    <script src="../src/dot.js"></script>
    <script src="../src/tickcontext.js"></script>
    <script src="../src/tickable.js"></script>
    <script src="../src/note.js"></script>
    <script src="../src/bend.js"></script>
    <script src="../src/stem.js"></script>
    <script src="../src/notehead.js"></script>
    <script src="../src/stemmablenote.js"></script>
    <script src="../src/stavenote.js"></script>
    <script src="../src/tabnote.js"></script>
    <script src="../src/barnote.js"></script>
    <script src="../src/clefnote.js"></script>
    <script src="../src/timesignote.js"></script>
    <script src="../src/ghostnote.js"></script>
    <script src="../src/formatter.js"></script>
    <script src="../src/stavetie.js"></script>
    <script src="../src/stavehairpin.js"></script>
    <script src="../src/tabtie.js"></script>
    <script src="../src/tabslide.js"></script>
    <script src="../src/beam.js"></script>
    <script src="../src/vibrato.js"></script>
    <script src="../src/annotation.js"></script>
    <script src="../src/tuning.js"></script>
    <script src="../src/stavemodifier.js"></script>
    <script src="../src/keysignature.js"></script>
    <script src="../src/timesignature.js"></script>
    <script src="../src/clef.js"></script>
    <script src="../src/music.js"></script>
    <script src="../src/keymanager.js"></script>
    <script src="../src/renderer.js"></script>
    <script src="../src/stavebarline.js"></script>
    <script src="../src/stavevolta.js"></script>
    <script src="../src/staverepetition.js"></script>
    <script src="../src/stavesection.js"></script>
    <script src="../src/stavetempo.js"></script>
    <script src="../src/stavetext.js"></script>
    <script src="../src/articulation.js"></script>
    <script src="../src/tremolo.js"></script>
    <script src="../src/raphaelcontext.js"></script>
    <script src="../src/canvascontext.js"></script>
    <script src="../src/tuplet.js"></script>
    <script src="../src/boundingbox.js"></script>
    <script src="../src/textnote.js"></script>
    <script src="../src/strokes.js"></script>
    <script src="../src/stringnumber.js"></script>
    <script src="../src/svgcontext.js"></script>
    <script src="../src/frethandfinger.js"></script>
    <script src="../src/gracenote.js"></script>
    <script src="../src/gracenotegroup.js"></script>
    <script src="../src/curve.js"></script>
    <script src="../src/staveline.js"></script>
    <script src="../src/crescendo.js"></script>
    <script src="../src/ornament.js"></script>
    <script src="../src/pedalmarking.js"></script>
    <script src="../src/textbracket.js"></script>
    <script src="../src/textdynamics.js"></script>

    <script src="../src/measure.js"></script>
    <script src="../src/musicxml.js"></script>
    <script src="../src/document.js"></script>
    <script src="../src/documentformatter.js"></script>

    <script>
      // source: http://stackoverflow.com/a/901144
      function getParameter(name) {
        name = name.replace(/\[]/, "\\\[").replace(/[\]]/, "\\\]");
        var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
        var results = regex.exec(window.location.search);
        if (results == null) return undefined;
        else return decodeURIComponent(results[1].replace(/\+/g, " "));
      }

      var doc = null;
      var formatter = null;
      $(document).ready(function() {
        var req = new XMLHttpRequest();
        var uri = getParameter('doc');
        if (! uri) uri = 'bach_bwv846p.xml';
        uri = 'resources/' + uri;
        req.open('GET', uri, true);
        req.onreadystatechange = function() {
          if (req.readyState != 4) return;
          doc = new Vex.Flow.Document(req.responseText);
          formatter = doc.getFormatter();
          formatter.setWidth(800).draw($("#viewer")[0]);
        };
        req.send(null);
      });
    </script>
    <style>
      #viewer {
        width: 100%;
        overflow: hidden;
      }
    </style>
  </head>
  <body>
    <div id="viewer">
      <p>Please enable JavaScript to use the viewer.</p>
    </div>
  </body>
</html>
